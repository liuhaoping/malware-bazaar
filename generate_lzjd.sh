#!/bin/bash

# Goal : Download samples, generate lzjd_hash and merge signatures, tlsh, etc. to a csv file
#
# input_folder : location of binary malware files 
# output_file: malware_bazaar.lzjd.csv
# putput-fle example:
# sha_256,sha1_hash,tlsh,signature,file_type,lzjd
#
# command example : 
# $ ./generate_lzjd.sh ~/mb_binarys_2022/ mb2022.lzjd.csv
###

input_folder=${1%}
output_file=${2%}

# generate SBDFs from input folder 
java -cp ~/jLZJD/target/jLZJD-1.0-SNAPSHOT-jar-with-dependencies.jar com.edwardraff.jlzjd.Main -r ${input_folder} -o  ${output_file}.tmp

# generate sha256,tlsh,lzjd list into csv file
cd ~/malware-bazaar/
python merge_lzjd_n_signature.py ${output_file}.tmp ${output_file}

rm *.tmp



























